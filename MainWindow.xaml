<Window x:Class="Manapost.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Manapost - EasyPost Label Maker" 
        Height="550" 
        Width="1000"
        Background="#E8E8E8" ResizeMode="CanMinimize">

    <Grid Margin="20" x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="342*" />
            <ColumnDefinition Width="42*"/>
            <ColumnDefinition Width="575*" />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,0,0,10">
            <Image Source="./Assets/snowimage.png" Height="30" Width="30" Margin="0,0,10,0" />
            <TextBlock Text="Manapost - EasyPost Label Maker" 
                      FontFamily="{StaticResource MPlantin}"
                      FontWeight="Bold" 
                      FontSize="20" 
                      VerticalAlignment="Center" />
        </StackPanel>

        <Border Grid.Row="1" Grid.Column="0" 
                Background="#F5F5F5" 
                CornerRadius="8" 
                Margin="0,0,531,0" Grid.ColumnSpan="3"
                x:Name="FromBorder">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="2" Color="Gray" Opacity="0.3" BlurRadius="5"/>
            </Border.Effect>

            <StackPanel Margin="15">
                <TextBlock Text="From Address" FontWeight="Bold" Margin="0,0,0,10" />

                <TextBox x:Name="NameEntry" Tag="Name" Height="30" Margin="0,0,0,8" VerticalContentAlignment="Center" />
                <TextBox x:Name="Address1Entry" Tag="Address1" Height="30" Margin="0,0,0,8" VerticalContentAlignment="Center" />
                <TextBox x:Name="Address2Entry" Tag="Address2" Height="30" Margin="0,0,0,8" VerticalContentAlignment="Center" />

                <Grid Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1.5*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="CityEntry" Tag="City" Grid.Column="0" Margin="0,0,5,0" Height="30" VerticalContentAlignment="Center" />
                    <TextBox x:Name="StateEntry" Tag="State" Grid.Column="1" Margin="0,0,5,0" Height="30" VerticalContentAlignment="Center" />
                    <TextBox x:Name="ZipEntry" Tag="ZIP" Grid.Column="2" Margin="0,0,5,0" Height="30" VerticalContentAlignment="Center" />
                    <Button x:Name="SaveFromAddressButton" Content="Save From Address" 
                            Grid.Column="3" Height="30" Padding="10,0" Click="SaveFromAddress"/>
                </Grid>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10" Height="18">
                    <TextBlock Text="Label Size" FontWeight="Bold" Height="18" Width="104" />
                    <TextBlock Text="Printer" FontWeight="Bold" Height="18" Width="106" />
                    <TextBlock Text="Print Directly?" FontWeight="Bold" Height="18" Width="111" />

                </StackPanel>

                <Grid Margin="0,0,0,15" Height="42" Width="380">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="0*"/>
                        <RowDefinition Height="1"/>
                        <RowDefinition Height="0"/>
                        <RowDefinition Height="0"/>
                        <RowDefinition Height="38"/>
                        <RowDefinition Height="1"/>
                        <RowDefinition Height="0"/>
                        <RowDefinition Height="0*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0*" />
                        <ColumnDefinition Width="0*"/>
                        <ColumnDefinition Width="50*"/>
                        <ColumnDefinition Width="0*" />
                        <ColumnDefinition Width="57*"/>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <ComboBox x:Name="LabelSizePicker" Grid.Column="0" Height="38" Grid.Row="4" Grid.ColumnSpan="3" Margin="0,0,10,0">
                        <ComboBoxItem Content="4x6" />
                        <ComboBoxItem Content="7x3" />
                        <ComboBoxItem Content="8.5x11" />
                    </ComboBox>

                    <ComboBox x:Name="PrinterPicker" Height="38" Grid.Row="4" Grid.Column="3" SelectionChanged="PrinterPicker_SelectionChanged" Grid.ColumnSpan="2" />

                    <CheckBox x:Name="PrintDirectlyCheckBox" IsChecked="True" 
                             Grid.Column="5" Grid.Row="4" Height="32" Width="30" Margin="5,0,0,0" />

                    <Button x:Name="SavePrinterSettingsButton" Content="Save Print Settings" 
                            Grid.Column="6" Height="30" Padding="10,0" Click="SavePrinterSettings" HorizontalAlignment="Center" Grid.Row="4" Width="131"/>
                </Grid>

                <TextBlock Text="EasyPost API Key" FontWeight="Bold" Margin="0,0,0,10" />
                <TextBox x:Name="ApiKeyEntry" Tag="Enter API Key" Height="30" Margin="0,0,0,10" VerticalContentAlignment="Center"/>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <Button x:Name="TestAPIKeyButton" Content="Test API Key" 
                            Height="30" Padding="15,0" Margin="0,0,10,0" Click="TestAPIKey"/>
                    <Button x:Name="SaveAPIKeyButton" Content="Save API Key" 
                            Height="30" Padding="15,0" Margin="0,0,10,0" Click="SaveAPIKey"/>
                </StackPanel>

                <Border x:Name="DynamicArea" Background="Transparent" MinHeight="30">
                    <TextBlock x:Name="DynamicLabel" Text="Enter EasyPost API key above!" 
                              VerticalAlignment="Center" HorizontalAlignment="Center" />
                </Border>
            </StackPanel>
        </Border>

        <Border Grid.Row="1" Grid.Column="2" 
                Background="LightGray" 
                CornerRadius="8" 
                Margin="50,0,0,0"
                x:Name="ToBorder">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="2" Color="Gray" Opacity="0.3" BlurRadius="5"/>
            </Border.Effect>

            <StackPanel Margin="15">

                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="To Address" FontWeight="Bold" Width="377" />
                    <TextBlock Text="Box" Width="24" />
                    <ToggleButton x:Name="AddressToggle" 
                        Width="55" 
                        Checked="AddressToggled" 
                        Unchecked="AddressToggled" Height="25" RenderTransformOrigin="0.5,0.5">
                        <ToggleButton.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform ScaleX="0.8" ScaleY="0.8"/>
                                <SkewTransform/>
                                <RotateTransform/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </ToggleButton.RenderTransform>
                        <ToggleButton.Template>
                            <ControlTemplate TargetType="{x:Type ToggleButton}">
                                <Grid>
                                    <Border x:Name="Border" CornerRadius="12" 
                                        Background="#CCCCCC" Width="50" Height="25">
                                        <Canvas>
                                            <Ellipse x:Name="Slider" Width="21" Height="21" 
                                                Fill="White" Canvas.Left="2" Canvas.Top="2">
                                                <Ellipse.Effect>
                                                    <DropShadowEffect ShadowDepth="1" Color="Gray" 
                                                        Opacity="0.3" BlurRadius="2"/>
                                                </Ellipse.Effect>
                                            </Ellipse>
                                        </Canvas>
                                    </Border>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#007ACC"/>
                                        <Setter TargetName="Slider" Property="Canvas.Left" Value="27"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </ToggleButton.Template>
                    </ToggleButton>
                    <TextBlock Text="Lines" Width="42" />

                </StackPanel>

                <TextBox x:Name="CopyPastableAddress" 
                        Tag="Paste address here...." 
                        Height="144" 
                        Margin="0,0,0,0"
                        TextWrapping="Wrap"
                        AcceptsReturn="True"
                        VerticalScrollBarVisibility="Auto" />

                <TextBox x:Name="ToNameEntry" Tag="Name" Height="30" Margin="0,0,0,8" />
                <TextBox x:Name="ToAddress1Entry" Tag="Address1" Height="30" Margin="0,0,0,8" />
                <TextBox x:Name="ToAddress2Entry" Tag="Address2" Height="30" Margin="0,0,0,8" />

                <Grid Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1.5*" />
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="ToCityEntry" Tag="City" Grid.Column="0" Margin="0,0,5,0" Height="30" />
                    <TextBox x:Name="ToStateEntry" Tag="State" Grid.Column="1" Margin="0,0,5,0" Height="30" />
                    <TextBox x:Name="ToZipEntry" Tag="ZIP" Grid.Column="2" Height="30" />
                </Grid>

                <Grid Margin="0,10,0,15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Weight" VerticalAlignment="Center" Margin="0,0,0,5" FontWeight="Bold" />
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="Type" VerticalAlignment="Top" Margin="0,0,0,0" FontWeight="Bold" />
                    <TextBlock Grid.Row="0" Grid.Column="2" Text="Non Machinable" VerticalAlignment="Top" Margin="0,0,10,0" FontWeight="Bold" />
                    <TextBlock Grid.Row="0" Grid.Column="3" Text="Cost" VerticalAlignment="Top" Margin="35,0,0,0" FontWeight="Bold" />

                    <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal">
                        <TextBox x:Name="WeightLbsEntry" Tag="Lbs" Width="50" Height="35" 
                                Margin="0,0,5,0" IsReadOnly="True" IsEnabled="False" FontSize="16" TextAlignment="Center" />
                        <TextBox x:Name="WeightOzEntry" Tag="Oz" Width="50" Height="35" FontSize="16" TextAlignment="Center" VerticalContentAlignment="Center" MaxLength="2" MaxLines="1" />
                    </StackPanel>

                    <ComboBox Grid.Row="1" Grid.Column="1" x:Name="ToTypePicker" Height="37" SelectionChanged="OnPickerSelectionChanged" Margin="0,0,10,0">
                        <ComboBoxItem Content="Letter" />
                        <ComboBoxItem Content="Flat" />
                    </ComboBox>

                    <CheckBox Grid.Row="1" Grid.Column="2" x:Name="MachineCheckBox" 
                             VerticalAlignment="Center" HorizontalAlignment="Center" />

                    <TextBlock Grid.Row="1" Grid.Column="3" x:Name="Cost" Text="Error" 
                              VerticalAlignment="Center" Margin="35,0,0,0" FontWeight="Bold" />
                </Grid>

                <StackPanel Margin="0,10,0,0">

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="60" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="51*"/>
                            <ColumnDefinition Width="332*"/>
                        </Grid.ColumnDefinitions>
                    </Grid>

                    <Button x:Name="BuyLabelButton" Content="Buy Label" 
                           Height="35" FontSize="14" FontWeight="Bold" Click="BuyLabel" HorizontalAlignment="Center" Width="300"/>
                </StackPanel>
                <StackPanel Orientation="Vertical" Margin="0,10,0,0">
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <TextBlock Text="Account Balance: " FontWeight="Bold" />
                        <TextBlock x:Name="AccountBalance" Text="$0.00" FontWeight="Bold" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <TextBlock Text="Labels Remaining This Month:" FontWeight="Bold" />
                        <TextBlock x:Name="LabelsRemaining" Text="0" FontWeight="Bold" Margin="5,0,0,0" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>

    <!-- placeholder text -->
    <Window.Resources>
        <Style TargetType="TextBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <Grid>
                                <ScrollViewer x:Name="PART_ContentHost" />
                                <TextBlock x:Name="Placeholder" 
                                          Text="{TemplateBinding Tag}"
                                          Foreground="Gray"
                                          Margin="5,0,0,0"
                                          VerticalAlignment="Center"
                                          IsHitTestVisible="False"
                                          Visibility="Collapsed" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Text" Value="" />
                                    <Condition Property="IsFocused" Value="False" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Placeholder" Property="Visibility" Value="Visible" />
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
</Window>